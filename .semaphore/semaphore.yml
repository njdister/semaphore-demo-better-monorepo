version: "v1.0"
name: Better Monorepo Project
agent:
  machine:
    type: e1-standard-2
    os_image: ubuntu2004
blocks:
  - name: No-Op
    dependencies: []
    task:
      jobs:
        - name: No-Op
          commands:
            - echo "Initializing"
promotions:
  - name: JS Service 1
    pipeline_file: js-service-1.yml
    auto_promote:
      when: "change_in('/javascript/js-service-1/', {default_branch: 'main'})"
  - name: JS Service 2
    pipeline_file: js-service-2.yml
    auto_promote:
      when: "change_in('/javascript/js-service-2/', {default_branch: 'main'})"
  - name: Go Service 1
    pipeline_file: go-service-1.yml
    auto_promote:
      when: "change_in('/golang/go-service-1/', {default_branch: 'main'})"
  - name: Go Service 2
    pipeline_file: go-service-2.yml
    auto_promote:
      when: "change_in('/golang/go-service-2/', {default_branch: 'main'})"
